var tutao="undefined"!=typeof tutao?tutao:{};tutao.global=this,tutao.provide=function(t){var e=t.split("."),o=tutao.global;e[0]in o||!o.execScript||o.execScript("var "+e[0]);for(var n;e.length&&(n=e.shift());)o=o[n]?o[n]:o[n]={}},Object.create||(Object.create=function(t,e){function o(){}if("undefined"!=typeof e)throw"The multiple-argument version of Object.create is not provided by this browser and cannot be shimmed.";return o.prototype=t,new o});
!function(){function r(r){var t,e,o,h,f,i;for(o=r.length,e=0,t="";o>e;){if(h=255&r.charCodeAt(e++),e==o){t+=a.charAt(h>>2),t+=a.charAt((3&h)<<4),t+="==";break}if(f=r.charCodeAt(e++),e==o){t+=a.charAt(h>>2),t+=a.charAt((3&h)<<4|(240&f)>>4),t+=a.charAt((15&f)<<2),t+="=";break}i=r.charCodeAt(e++),t+=a.charAt(h>>2),t+=a.charAt((3&h)<<4|(240&f)>>4),t+=a.charAt((15&f)<<2|(192&i)>>6),t+=a.charAt(63&i)}return t}function t(r){var t,a,o,h,f,i,n;for(i=r.length,f=0,n="";i>f;){do t=e[255&r.charCodeAt(f++)];while(i>f&&-1==t);if(-1==t)break;do a=e[255&r.charCodeAt(f++)];while(i>f&&-1==a);if(-1==a)break;n+=String.fromCharCode(t<<2|(48&a)>>4);do{if(o=255&r.charCodeAt(f++),61==o)return n;o=e[o]}while(i>f&&-1==o);if(-1==o)break;n+=String.fromCharCode((15&a)<<4|(60&o)>>2);do{if(h=255&r.charCodeAt(f++),61==h)return n;h=e[h]}while(i>f&&-1==h);if(-1==h)break;n+=String.fromCharCode((3&o)<<6|h)}return n}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);"undefined"==typeof btoa&&(btoa=r),"undefined"==typeof atob&&(atob=t)}();
function BigInteger(t,r,e){null!=t&&("number"==typeof t?this.fromNumber(t,r,e):null==r&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,r))}function nbi(){return new BigInteger(null)}function am1(t,r,e,n,i,o){for(;--o>=0;){var s=r*this[t++]+e[n]+i;i=Math.floor(s/67108864),e[n++]=67108863&s}return i}function am2(t,r,e,n,i,o){for(var s=32767&r,h=r>>15;--o>=0;){var a=32767&this[t],u=this[t++]>>15,g=h*a+u*s;a=s*a+((32767&g)<<15)+e[n]+(1073741823&i),i=(a>>>30)+(g>>>15)+h*u+(i>>>30),e[n++]=1073741823&a}return i}function am3(t,r,e,n,i,o){for(var s=16383&r,h=r>>14;--o>=0;){var a=16383&this[t],u=this[t++]>>14,g=h*a+u*s;a=s*a+((16383&g)<<14)+e[n]+i,i=(a>>28)+(g>>14)+h*u,e[n++]=268435455&a}return i}function int2char(t){return BI_RM.charAt(t)}function intAt(t,r){var e=BI_RC[t.charCodeAt(r)];return null==e?-1:e}function bnpCopyTo(t){for(var r=this.t-1;r>=0;--r)t[r]=this[r];t.t=this.t,t.s=this.s}function bnpFromInt(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+DV:this.t=0}function nbv(t){var r=nbi();return r.fromInt(t),r}function bnpFromString(t,r){var e;if(16==r)e=4;else if(8==r)e=3;else if(256==r)e=8;else if(2==r)e=1;else if(32==r)e=5;else{if(4!=r)return this.fromRadix(t,r),void 0;e=2}this.t=0,this.s=0;for(var n=t.length,i=!1,o=0;--n>=0;){var s=8==e?255&t[n]:intAt(t,n);0>s?"-"==t.charAt(n)&&(i=!0):(i=!1,0==o?this[this.t++]=s:o+e>this.DB?(this[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this[this.t++]=s>>this.DB-o):this[this.t-1]|=s<<o,o+=e,o>=this.DB&&(o-=this.DB))}8==e&&0!=(128&t[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function bnToString(t){if(this.s<0)return"-"+this.negate().toString(t);var r;if(16==t)r=4;else if(8==t)r=3;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return this.toRadix(t);r=2}var e,n=(1<<r)-1,i=!1,o="",s=this.t,h=this.DB-s*this.DB%r;if(s-->0)for(h<this.DB&&(e=this[s]>>h)>0&&(i=!0,o=int2char(e));s>=0;)r>h?(e=(this[s]&(1<<h)-1)<<r-h,e|=this[--s]>>(h+=this.DB-r)):(e=this[s]>>(h-=r)&n,0>=h&&(h+=this.DB,--s)),e>0&&(i=!0),i&&(o+=int2char(e));return i?o:"0"}function bnNegate(){var t=nbi();return BigInteger.ZERO.subTo(this,t),t}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(t){var r=this.s-t.s;if(0!=r)return r;var e=this.t;if(r=e-t.t,0!=r)return this.s<0?-r:r;for(;--e>=0;)if(0!=(r=this[e]-t[e]))return r;return 0}function nbits(t){var r,e=1;return 0!=(r=t>>>16)&&(t=r,e+=16),0!=(r=t>>8)&&(t=r,e+=8),0!=(r=t>>4)&&(t=r,e+=4),0!=(r=t>>2)&&(t=r,e+=2),0!=(r=t>>1)&&(t=r,e+=1),e}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(t,r){var e;for(e=this.t-1;e>=0;--e)r[e+t]=this[e];for(e=t-1;e>=0;--e)r[e]=0;r.t=this.t+t,r.s=this.s}function bnpDRShiftTo(t,r){for(var e=t;e<this.t;++e)r[e-t]=this[e];r.t=Math.max(this.t-t,0),r.s=this.s}function bnpLShiftTo(t,r){var e,n=t%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(t/this.DB),h=this.s<<n&this.DM;for(e=this.t-1;e>=0;--e)r[e+s+1]=this[e]>>i|h,h=(this[e]&o)<<n;for(e=s-1;e>=0;--e)r[e]=0;r[s]=h,r.t=this.t+s+1,r.s=this.s,r.clamp()}function bnpRShiftTo(t,r){r.s=this.s;var e=Math.floor(t/this.DB);if(e>=this.t)return r.t=0,void 0;var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;r[0]=this[e]>>n;for(var s=e+1;s<this.t;++s)r[s-e-1]|=(this[s]&o)<<i,r[s-e]=this[s]>>n;n>0&&(r[this.t-e-1]|=(this.s&o)<<i),r.t=this.t-e,r.clamp()}function bnpSubTo(t,r){for(var e=0,n=0,i=Math.min(t.t,this.t);i>e;)n+=this[e]-t[e],r[e++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;e<this.t;)n+=this[e],r[e++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;e<t.t;)n-=t[e],r[e++]=n&this.DM,n>>=this.DB;n-=t.s}r.s=0>n?-1:0,-1>n?r[e++]=this.DV+n:n>0&&(r[e++]=n),r.t=e,r.clamp()}function bnpMultiplyTo(t,r){var e=this.abs(),n=t.abs(),i=e.t;for(r.t=i+n.t;--i>=0;)r[i]=0;for(i=0;i<n.t;++i)r[i+e.t]=e.am(0,n[i],r,i,0,e.t);r.s=0,r.clamp(),this.s!=t.s&&BigInteger.ZERO.subTo(r,r)}function bnpSquareTo(t){for(var r=this.abs(),e=t.t=2*r.t;--e>=0;)t[e]=0;for(e=0;e<r.t-1;++e){var n=r.am(e,r[e],t,2*e,0,1);(t[e+r.t]+=r.am(e+1,2*r[e],t,2*e+1,n,r.t-e-1))>=r.DV&&(t[e+r.t]-=r.DV,t[e+r.t+1]=1)}t.t>0&&(t[t.t-1]+=r.am(e,r[e],t,2*e,0,1)),t.s=0,t.clamp()}function bnpDivRemTo(t,r,e){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=r&&r.fromInt(0),null!=e&&this.copyTo(e),void 0;null==e&&(e=nbi());var o=nbi(),s=this.s,h=t.s,a=this.DB-nbits(n[n.t-1]);a>0?(n.lShiftTo(a,o),i.lShiftTo(a,e)):(n.copyTo(o),i.copyTo(e));var u=o.t,g=o[u-1];if(0!=g){var p=g*(1<<this.F1)+(u>1?o[u-2]>>this.F2:0),f=this.FV/p,l=(1<<this.F1)/p,b=1<<this.F2,m=e.t,c=m-u,d=null==r?nbi():r;for(o.dlShiftTo(c,d),e.compareTo(d)>=0&&(e[e.t++]=1,e.subTo(d,e)),BigInteger.ONE.dlShiftTo(u,d),d.subTo(o,o);o.t<u;)o[o.t++]=0;for(;--c>=0;){var _=e[--m]==g?this.DM:Math.floor(e[m]*f+(e[m-1]+b)*l);if((e[m]+=o.am(0,_,e,c,0,u))<_)for(o.dlShiftTo(c,d),e.subTo(d,e);e[m]<--_;)e.subTo(d,e)}null!=r&&(e.drShiftTo(u,r),s!=h&&BigInteger.ZERO.subTo(r,r)),e.t=u,e.clamp(),a>0&&e.rShiftTo(a,e),0>s&&BigInteger.ZERO.subTo(e,e)}}}function bnMod(t){var r=nbi();return this.abs().divRemTo(t,null,r),this.s<0&&r.compareTo(BigInteger.ZERO)>0&&t.subTo(r,r),r}function Classic(t){this.m=t}function cConvert(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function cRevert(t){return t}function cReduce(t){t.divRemTo(this.m,null,t)}function cMulTo(t,r,e){t.multiplyTo(r,e),this.reduce(e)}function cSqrTo(t,r){t.squareTo(r),this.reduce(r)}function bnpInvDigit(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var r=3&t;return r=r*(2-(15&t)*r)&15,r=r*(2-(255&t)*r)&255,r=r*(2-((65535&t)*r&65535))&65535,r=r*(2-t*r%this.DV)%this.DV,r>0?this.DV-r:-r}function Montgomery(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function montConvert(t){var r=nbi();return t.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),t.s<0&&r.compareTo(BigInteger.ZERO)>0&&this.m.subTo(r,r),r}function montRevert(t){var r=nbi();return t.copyTo(r),this.reduce(r),r}function montReduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var r=0;r<this.m.t;++r){var e=32767&t[r],n=e*this.mpl+((e*this.mph+(t[r]>>15)*this.mpl&this.um)<<15)&t.DM;for(e=r+this.m.t,t[e]+=this.m.am(0,n,t,r,0,this.m.t);t[e]>=t.DV;)t[e]-=t.DV,t[++e]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function montSqrTo(t,r){t.squareTo(r),this.reduce(r)}function montMulTo(t,r,e){t.multiplyTo(r,e),this.reduce(e)}function bnpIsEven(){return 0==(this.t>0?1&this[0]:this.s)}function bnpExp(t,r){if(t>4294967295||1>t)return BigInteger.ONE;var e=nbi(),n=nbi(),i=r.convert(this),o=nbits(t)-1;for(i.copyTo(e);--o>=0;)if(r.sqrTo(e,n),(t&1<<o)>0)r.mulTo(n,i,e);else{var s=e;e=n,n=s}return r.revert(e)}function bnModPowInt(t,r){var e;return e=256>t||r.isEven()?new Classic(r):new Montgomery(r),this.exp(t,e)}function bnClone(){var t=nbi();return this.copyTo(t),t}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var r=this.chunkSize(t),e=Math.pow(t,r),n=nbv(e),i=nbi(),o=nbi(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(e+o.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(t)+s}function bnpFromRadix(t,r){this.fromInt(0),null==r&&(r=10);for(var e=this.chunkSize(r),n=Math.pow(r,e),i=!1,o=0,s=0,h=0;h<t.length;++h){var a=intAt(t,h);0>a?"-"==t.charAt(h)&&0==this.signum()&&(i=!0):(s=r*s+a,++o>=e&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0))}o>0&&(this.dMultiply(Math.pow(r,o)),this.dAddOffset(s,0)),i&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(t,r,e){if("number"==typeof r)if(2>t)this.fromInt(1);else for(this.fromNumber(t,e),this.testBit(t-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(t-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(r);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(BigInteger.ONE.shiftLeft(t-1),this);else{var n=new Array,i=7&t;n.length=(t>>3)+1,r.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function bnToByteArray(){var t=this.t,r=new Array;r[0]=this.s;var e,n=this.DB-t*this.DB%8,i=0;if(t-->0)for(n<this.DB&&(e=this[t]>>n)!=(this.s&this.DM)>>n&&(r[i++]=e|this.s<<this.DB-n);t>=0;)8>n?(e=(this[t]&(1<<n)-1)<<8-n,e|=this[--t]>>(n+=this.DB-8)):(e=this[t]>>(n-=8)&255,0>=n&&(n+=this.DB,--t)),0!=(128&e)&&(e|=-256),0==i&&(128&this.s)!=(128&e)&&++i,(i>0||e!=this.s)&&(r[i++]=e);return r}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(t){return this.compareTo(t)<0?this:t}function bnMax(t){return this.compareTo(t)>0?this:t}function bnpBitwiseTo(t,r,e){var n,i,o=Math.min(t.t,this.t);for(n=0;o>n;++n)e[n]=r(this[n],t[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)e[n]=r(this[n],i);e.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)e[n]=r(i,t[n]);e.t=t.t}e.s=r(this.s,t.s),e.clamp()}function op_and(t,r){return t&r}function bnAnd(t){var r=nbi();return this.bitwiseTo(t,op_and,r),r}function op_or(t,r){return t|r}function bnOr(t){var r=nbi();return this.bitwiseTo(t,op_or,r),r}function op_xor(t,r){return t^r}function bnXor(t){var r=nbi();return this.bitwiseTo(t,op_xor,r),r}function op_andnot(t,r){return t&~r}function bnAndNot(t){var r=nbi();return this.bitwiseTo(t,op_andnot,r),r}function bnNot(){for(var t=nbi(),r=0;r<this.t;++r)t[r]=this.DM&~this[r];return t.t=this.t,t.s=~this.s,t}function bnShiftLeft(t){var r=nbi();return 0>t?this.rShiftTo(-t,r):this.lShiftTo(t,r),r}function bnShiftRight(t){var r=nbi();return 0>t?this.lShiftTo(-t,r):this.rShiftTo(t,r),r}function lbit(t){if(0==t)return-1;var r=0;return 0==(65535&t)&&(t>>=16,r+=16),0==(255&t)&&(t>>=8,r+=8),0==(15&t)&&(t>>=4,r+=4),0==(3&t)&&(t>>=2,r+=2),0==(1&t)&&++r,r}function bnGetLowestSetBit(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+lbit(this[t]);return this.s<0?this.t*this.DB:-1}function cbit(t){for(var r=0;0!=t;)t&=t-1,++r;return r}function bnBitCount(){for(var t=0,r=this.s&this.DM,e=0;e<this.t;++e)t+=cbit(this[e]^r);return t}function bnTestBit(t){var r=Math.floor(t/this.DB);return r>=this.t?0!=this.s:0!=(this[r]&1<<t%this.DB)}function bnpChangeBit(t,r){var e=BigInteger.ONE.shiftLeft(t);return this.bitwiseTo(e,r,e),e}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(t,r){for(var e=0,n=0,i=Math.min(t.t,this.t);i>e;)n+=this[e]+t[e],r[e++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;e<this.t;)n+=this[e],r[e++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;e<t.t;)n+=t[e],r[e++]=n&this.DM,n>>=this.DB;n+=t.s}r.s=0>n?-1:0,n>0?r[e++]=n:-1>n&&(r[e++]=this.DV+n),r.t=e,r.clamp()}function bnAdd(t){var r=nbi();return this.addTo(t,r),r}function bnSubtract(t){var r=nbi();return this.subTo(t,r),r}function bnMultiply(t){var r=nbi();return this.multiplyTo(t,r),r}function bnSquare(){var t=nbi();return this.squareTo(t),t}function bnDivide(t){var r=nbi();return this.divRemTo(t,r,null),r}function bnRemainder(t){var r=nbi();return this.divRemTo(t,null,r),r}function bnDivideAndRemainder(t){var r=nbi(),e=nbi();return this.divRemTo(t,r,e),new Array(r,e)}function bnpDMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(t,r){if(0!=t){for(;this.t<=r;)this[this.t++]=0;for(this[r]+=t;this[r]>=this.DV;)this[r]-=this.DV,++r>=this.t&&(this[this.t++]=0),++this[r]}}function NullExp(){}function nNop(t){return t}function nMulTo(t,r,e){t.multiplyTo(r,e)}function nSqrTo(t,r){t.squareTo(r)}function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(t,r,e){var n=Math.min(this.t+t.t,r);for(e.s=0,e.t=n;n>0;)e[--n]=0;var i;for(i=e.t-this.t;i>n;++n)e[n+this.t]=this.am(0,t[n],e,n,0,this.t);for(i=Math.min(t.t,r);i>n;++n)this.am(0,t[n],e,n,0,r-n);e.clamp()}function bnpMultiplyUpperTo(t,r,e){--r;var n=e.t=this.t+t.t-r;for(e.s=0;--n>=0;)e[n]=0;for(n=Math.max(r-this.t,0);n<t.t;++n)e[this.t+n-r]=this.am(r-n,t[n],e,0,0,this.t+n-r);e.clamp(),e.drShiftTo(1,e)}function Barrett(t){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function barrettConvert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var r=nbi();return t.copyTo(r),this.reduce(r),r}function barrettRevert(t){return t}function barrettReduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function barrettSqrTo(t,r){t.squareTo(r),this.reduce(r)}function barrettMulTo(t,r,e){t.multiplyTo(r,e),this.reduce(e)}function bnModPow(t,r){var e=this.toString(16),n=t.toString(16),i=r.toString(16),o=powMod(str2bigInt(e,16),str2bigInt(n,16),str2bigInt(i,16));return new BigInteger(bigInt2str(o,16),16)}function bnGCD(t){var r=this.s<0?this.negate():this.clone(),e=t.s<0?t.negate():t.clone();if(r.compareTo(e)<0){var n=r;r=e,e=n}var i=r.getLowestSetBit(),o=e.getLowestSetBit();if(0>o)return r;for(o>i&&(o=i),o>0&&(r.rShiftTo(o,r),e.rShiftTo(o,e));r.signum()>0;)(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),r.compareTo(e)>=0?(r.subTo(e,r),r.rShiftTo(1,r)):(e.subTo(r,e),e.rShiftTo(1,e));return o>0&&e.lShiftTo(o,e),e}function bnpModInt(t){if(0>=t)return 0;var r=this.DV%t,e=this.s<0?t-1:0;if(this.t>0)if(0==r)e=this[0]%t;else for(var n=this.t-1;n>=0;--n)e=(r*e+this[n])%t;return e}function bnModInverse(t){var r=t.isEven();if(this.isEven()&&r||0==t.signum())return BigInteger.ZERO;for(var e=t.clone(),n=this.clone(),i=nbv(1),o=nbv(0),s=nbv(0),h=nbv(1);0!=e.signum();){for(;e.isEven();)e.rShiftTo(1,e),r?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),r?(s.isEven()&&h.isEven()||(s.addTo(this,s),h.subTo(t,h)),s.rShiftTo(1,s)):h.isEven()||h.subTo(t,h),h.rShiftTo(1,h);e.compareTo(n)>=0?(e.subTo(n,e),r&&i.subTo(s,i),o.subTo(h,o)):(n.subTo(e,n),r&&s.subTo(i,s),h.subTo(o,h))}return 0!=n.compareTo(BigInteger.ONE)?BigInteger.ZERO:h.compareTo(t)>=0?h.subtract(t):h.signum()<0?(h.addTo(t,h),h.signum()<0?h.add(t):h):h}function bnIsProbablePrime(t){var r,e=this.abs();if(1==e.t&&e[0]<=lowprimes[lowprimes.length-1]){for(r=0;r<lowprimes.length;++r)if(e[0]==lowprimes[r])return!0;return!1}if(e.isEven())return!1;for(r=1;r<lowprimes.length;){for(var n=lowprimes[r],i=r+1;i<lowprimes.length&&lplim>n;)n*=lowprimes[i++];for(n=e.modInt(n);i>r;)if(n%lowprimes[r++]==0)return!1}return e.millerRabin(t)}function bnpMillerRabin(t){var r=this.subtract(BigInteger.ONE),e=r.getLowestSetBit();if(0>=e)return!1;var n=r.shiftRight(e);t=t+1>>1,t>lowprimes.length&&(t=lowprimes.length);for(var i=nbi(),o=0;t>o;++o){i.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var s=i.modPow(n,this);if(0!=s.compareTo(BigInteger.ONE)&&0!=s.compareTo(r)){for(var h=1;h++<e&&0!=s.compareTo(r);)if(s=s.modPowInt(2,this),0==s.compareTo(BigInteger.ONE))return!1;if(0!=s.compareTo(r))return!1}}return!0}function parseBigInt(t,r){return new BigInteger(t,r)}function linebrk(t,r){for(var e="",n=0;n+r<t.length;)e+=t.substring(n,n+r)+"\n",n+=r;return e+t.substring(n,t.length)}function byte2Hex(t){return 16>t?"0"+t.toString(16):t.toString(16)}function pkcs1pad2(t,r){if(r<t.length+11)return alert("Message too long for RSA"),null;for(var e=new Array,n=t.length-1;n>=0&&r>0;){var i=t.charCodeAt(n--);128>i?e[--r]=i:i>127&&2048>i?(e[--r]=63&i|128,e[--r]=i>>6|192):(e[--r]=63&i|128,e[--r]=i>>6&63|128,e[--r]=i>>12|224)}e[--r]=0;for(var o=new SecureRandom,s=new Array;r>2;){for(s[0]=0;0==s[0];)o.nextBytes(s);e[--r]=s[0]}return e[--r]=2,e[--r]=0,new BigInteger(e)}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(t,r){null!=t&&null!=r&&t.length>0&&r.length>0?(this.n=parseBigInt(t,16),this.e=parseInt(r,16)):alert("Invalid RSA public key")}function RSADoPublic(t){return t.modPowInt(this.e,this.n)}function RSAEncrypt(t){var r=pkcs1pad2(t,this.n.bitLength()+7>>3);if(null==r)return null;var e=this.doPublic(r);if(null==e)return null;var n=e.toString(16);return 0==(1&n.length)?n:"0"+n}function pkcs1unpad2(t,r){for(var e=t.toByteArray(),n=0;n<e.length&&0==e[n];)++n;if(e.length-n!=r-1||2!=e[n])return null;for(++n;0!=e[n];)if(++n>=e.length)return null;for(var i="";++n<e.length;){var o=255&e[n];128>o?i+=String.fromCharCode(o):o>191&&224>o?(i+=String.fromCharCode((31&o)<<6|63&e[n+1]),++n):(i+=String.fromCharCode((15&o)<<12|(63&e[n+1])<<6|63&e[n+2]),n+=2)}return i}function RSASetPrivate(t,r,e){null!=t&&null!=r&&t.length>0&&r.length>0?(this.n=parseBigInt(t,16),this.e=parseInt(r,16),this.d=parseBigInt(e,16)):alert("Invalid RSA private key")}function RSASetPrivateEx(t,r,e,n,i,o,s,h){null!=t&&null!=r&&t.length>0&&r.length>0?(this.n=parseBigInt(t,16),this.e=parseInt(r,16),this.d=parseBigInt(e,16),this.p=parseBigInt(n,16),this.q=parseBigInt(i,16),this.dmp1=parseBigInt(o,16),this.dmq1=parseBigInt(s,16),this.coeff=parseBigInt(h,16)):alert("Invalid RSA private key")}function RSAGenerate(t,r){var e=new SecureRandom,n=t>>1;this.e=parseInt(r,16);for(var i=new BigInteger(r,16);;){for(;this.p=new BigInteger(t-n,10,e),0!=this.p.subtract(BigInteger.ONE).gcd(i).compareTo(BigInteger.ONE););for(;this.q=new BigInteger(n,10,e),0!=this.q.subtract(BigInteger.ONE).gcd(i).compareTo(BigInteger.ONE););if(this.p.compareTo(this.q)<=0){var o=this.p;this.p=this.q,this.q=o}var s=this.p.subtract(BigInteger.ONE),h=this.q.subtract(BigInteger.ONE),a=s.multiply(h);if(0==a.gcd(i).compareTo(BigInteger.ONE)){this.n=this.p.multiply(this.q),this.d=i.modInverse(a),this.dmp1=this.d.mod(s),this.dmq1=this.d.mod(h),this.coeff=this.q.modInverse(this.p);break}}}function RSADoPrivate(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var r=t.mod(this.p).modPow(this.dmp1,this.p),e=t.mod(this.q).modPow(this.dmq1,this.q);r.compareTo(e)<0;)r=r.add(this.p);return r.subtract(e).multiply(this.coeff).mod(this.p).multiply(this.q).add(e)}function RSADecrypt(t){var r=parseBigInt(t,16),e=this.doPrivate(r);return null==e?null:pkcs1unpad2(e,this.n.bitLength()+7>>3)}function findPrimes(t){var r,e,n,i;for(e=new Array(t),r=0;t>r;r++)e[r]=0;for(e[0]=2,n=0;e[n]<t;){for(r=e[n]*e[n];t>r;r+=e[n])e[r]=1;for(n++,e[n]=e[n-1]+1;e[n]<t&&e[e[n]];e[n]++);}for(i=new Array(n),r=0;n>r;r++)i[r]=e[r];return i}function millerRabinInt(t,r){return mr_x1.length!=t.length&&(mr_x1=dup(t),mr_r=dup(t),mr_a=dup(t)),copyInt_(mr_a,r),millerRabin(t,mr_a)}function millerRabin(t,r){var e,n,i,o;for(mr_x1.length!=t.length&&(mr_x1=dup(t),mr_r=dup(t),mr_a=dup(t)),copy_(mr_a,r),copy_(mr_r,t),copy_(mr_x1,t),addInt_(mr_r,-1),addInt_(mr_x1,-1),i=0,e=0;e<mr_r.length;e++)for(n=1;mask>n;n<<=1)t[e]&n?(o=i<mr_r.length+bpe?i:0,e=mr_r.length,n=mask):i++;if(o&&rightShift_(mr_r,o),powMod_(mr_a,mr_r,t),!equalsInt(mr_a,1)&&!equals(mr_a,mr_x1)){for(n=1;o-1>=n&&!equals(mr_a,mr_x1);){if(squareMod_(mr_a,t),equalsInt(mr_a,1))return 0;n++}if(!equals(mr_a,mr_x1))return 0}return 1}function bitSize(t){var r,e,n;for(r=t.length-1;0==t[r]&&r>0;r--);for(e=0,n=t[r];n;n>>=1,e++);return e+=bpe*r}function expand(t,r){var e=int2bigInt(0,(t.length>r?t.length:r)*bpe,0);return copy_(e,t),e}function randTruePrime(t){var r=int2bigInt(0,t,0);return randTruePrime_(r,t),trim(r,1)}function randProbPrime(t){return t>=600?randProbPrimeRounds(t,2):t>=550?randProbPrimeRounds(t,4):t>=500?randProbPrimeRounds(t,5):t>=400?randProbPrimeRounds(t,6):t>=350?randProbPrimeRounds(t,7):t>=300?randProbPrimeRounds(t,9):t>=250?randProbPrimeRounds(t,12):t>=200?randProbPrimeRounds(t,15):t>=150?randProbPrimeRounds(t,18):t>=100?randProbPrimeRounds(t,27):randProbPrimeRounds(t,40)}function randProbPrimeRounds(t,r){var e,n,i,o;for(o=3e4,e=int2bigInt(0,t,0),0==primes.length&&(primes=findPrimes(3e4)),rpprb.length!=e.length&&(rpprb=dup(e));;){for(randBigInt_(e,t,0),e[0]|=1,i=0,n=0;n<primes.length&&primes[n]<=o;n++)if(0==modInt(e,primes[n])&&!equalsInt(e,primes[n])){i=1;break}for(n=0;r>n&&!i;n++){for(randBigInt_(rpprb,t,0);!greater(e,rpprb);)randBigInt_(rpprb,t,0);millerRabin(e,rpprb)||(i=1)}if(!i)return e}}function mod(t,r){var e=dup(t);return mod_(e,r),trim(e,1)}function addInt(t,r){var e=expand(t,t.length+1);return addInt_(e,r),trim(e,1)}function mult(t,r){var e=expand(t,t.length+r.length);return mult_(e,r),trim(e,1)}function powMod(t,r,e){var n=expand(t,e.length);return powMod_(n,trim(r,2),trim(e,2),0),trim(n,1)}function sub(t,r){var e=expand(t,t.length>r.length?t.length+1:r.length+1);return sub_(e,r),trim(e,1)}function add(t,r){var e=expand(t,t.length>r.length?t.length+1:r.length+1);return add_(e,r),trim(e,1)}function inverseMod(t,r){var e,n=expand(t,r.length);return e=inverseMod_(n,r),e?trim(n,1):null}function multMod(t,r,e){var n=expand(t,e.length);return multMod_(n,r,e),trim(n,1)}function randBigInt(t,r){var e,n;return e=Math.floor((t-1)/bpe)+2,n=int2bigInt(0,0,e),randBigInt_(n,t,r),n}function GCD(t,r){var e,n;return e=dup(t),n=dup(r),GCD_(e,n),e}function GCD_(r,e){var n,i,o,s,h,a,u,g,p;for(T.length!=r.length&&(T=dup(r)),p=1;p;){for(p=0,n=1;n<e.length;n++)if(e[n]){p=1;break}if(!p)break;for(n=r.length;!r[n]&&n>=0;n--);for(i=r[n],o=e[n],s=1,h=0,a=0,u=1;o+a&&o+u&&(g=Math.floor((i+s)/(o+a)),qp=Math.floor((i+h)/(o+u)),g==qp);)t=s-g*a,s=a,a=t,t=h-g*u,h=u,u=t,t=i-g*o,i=o,o=t;h?(copy_(T,r),linComb_(r,e,s,h),linComb_(e,T,u,a)):(mod_(r,e),copy_(T,r),copy_(r,e),copy_(e,T))}if(0!=e[0])for(t=modInt(r,e[0]),copyInt_(r,e[0]),e[0]=t;e[0];)r[0]%=e[0],t=r[0],r[0]=e[0],e[0]=t}function inverseMod_(t,r){var e=1+2*Math.max(t.length,r.length);if(!(1&t[0]||1&r[0]))return copyInt_(t,0),0;for(eg_u.length!=e&&(eg_u=new Array(e),eg_v=new Array(e),eg_A=new Array(e),eg_B=new Array(e),eg_C=new Array(e),eg_D=new Array(e)),copy_(eg_u,t),copy_(eg_v,r),copyInt_(eg_A,1),copyInt_(eg_B,0),copyInt_(eg_C,0),copyInt_(eg_D,1);;){for(;!(1&eg_u[0]);)halve_(eg_u),1&eg_A[0]||1&eg_B[0]?(add_(eg_A,r),halve_(eg_A),sub_(eg_B,t),halve_(eg_B)):(halve_(eg_A),halve_(eg_B));for(;!(1&eg_v[0]);)halve_(eg_v),1&eg_C[0]||1&eg_D[0]?(add_(eg_C,r),halve_(eg_C),sub_(eg_D,t),halve_(eg_D)):(halve_(eg_C),halve_(eg_D));if(greater(eg_v,eg_u)?(sub_(eg_v,eg_u),sub_(eg_C,eg_A),sub_(eg_D,eg_B)):(sub_(eg_u,eg_v),sub_(eg_A,eg_C),sub_(eg_B,eg_D)),equalsInt(eg_u,0))return negative(eg_C)&&add_(eg_C,r),copy_(t,eg_C),equalsInt(eg_v,1)?1:(copyInt_(t,0),0)}}function inverseModInt(t,r){for(var e=1,n=0;;){if(1==t)return e;if(0==t)return 0;if(n-=e*Math.floor(r/t),r%=t,1==r)return n;if(0==r)return 0;e-=n*Math.floor(t/r),t%=r}}function inverseModInt_(t,r){return inverseModInt(t,r)}function eGCD_(t,r,e,n,i){var o=0,s=Math.max(t.length,r.length);for(eg_u.length!=s&&(eg_u=new Array(s),eg_A=new Array(s),eg_B=new Array(s),eg_C=new Array(s),eg_D=new Array(s));!(1&t[0]||1&r[0]);)halve_(t),halve_(r),o++;for(copy_(eg_u,t),copy_(e,r),copyInt_(eg_A,1),copyInt_(eg_B,0),copyInt_(eg_C,0),copyInt_(eg_D,1);;){for(;!(1&eg_u[0]);)halve_(eg_u),1&eg_A[0]||1&eg_B[0]?(add_(eg_A,r),halve_(eg_A),sub_(eg_B,t),halve_(eg_B)):(halve_(eg_A),halve_(eg_B));for(;!(1&e[0]);)halve_(e),1&eg_C[0]||1&eg_D[0]?(add_(eg_C,r),halve_(eg_C),sub_(eg_D,t),halve_(eg_D)):(halve_(eg_C),halve_(eg_D));if(greater(e,eg_u)?(sub_(e,eg_u),sub_(eg_C,eg_A),sub_(eg_D,eg_B)):(sub_(eg_u,e),sub_(eg_A,eg_C),sub_(eg_B,eg_D)),equalsInt(eg_u,0))return negative(eg_C)&&(add_(eg_C,r),sub_(eg_D,t)),multInt_(eg_D,-1),copy_(n,eg_C),copy_(i,eg_D),leftShift_(e,o),void 0}}function negative(t){return t[t.length-1]>>bpe-1&1}function greaterShift(t,r,e){var n,i=t.length,o=r.length;for(k=o>i+e?i+e:o,n=o-1-e;i>n&&n>=0;n++)if(t[n]>0)return 1;for(n=i-1+e;o>n;n++)if(r[n]>0)return 0;for(n=k-1;n>=e;n--){if(t[n-e]>r[n])return 1;if(t[n-e]<r[n])return 0}return 0}function greater(t,r){var e,n=t.length<r.length?t.length:r.length;for(e=t.length;e<r.length;e++)if(r[e])return 0;for(e=r.length;e<t.length;e++)if(t[e])return 1;for(e=n-1;e>=0;e--){if(t[e]>r[e])return 1;if(t[e]<r[e])return 0}return 0}function divide_(t,r,e,n){var i,o,s,h,a,u,g,p;for(copy_(n,t),o=r.length;0==r[o-1];o--);for(p=r[o-1],g=0;p;g++)p>>=1;for(g=bpe-g,leftShift_(r,g),leftShift_(n,g),i=n.length;0==n[i-1]&&i>o;i--);for(copyInt_(e,0);!greaterShift(r,n,i-o);)subShift_(n,r,i-o),e[i-o]++;for(s=i-1;s>=o;s--){for(e[s-o]=n[s]==r[o-1]?mask:Math.floor((n[s]*radix+n[s-1])/r[o-1]);a=(o>1?r[o-2]:0)*e[s-o],u=a>>bpe,a&=mask,h=u+e[s-o]*r[o-1],u=h>>bpe,h&=mask,u==n[s]?h==n[s-1]?a>(s>1?n[s-2]:0):h>n[s-1]:u>n[s];)e[s-o]--;linCombShift_(n,r,-e[s-o],s-o),negative(n)&&(addShift_(n,r,s-o),e[s-o]--)}rightShift_(r,g),rightShift_(n,g)}function carry_(t){var r,e,n,i;for(e=t.length,n=0,r=0;e>r;r++)n+=t[r],i=0,0>n&&(i=-(n>>bpe),n+=i*radix),t[r]=n&mask,n=(n>>bpe)-i}function modInt(t,r){var e,n=0;for(e=t.length-1;e>=0;e--)n=(n*radix+t[e])%r;return n}function int2bigInt(t,r,e){var n;return n=Math.ceil(r/bpe)+1,n=e>n?e:n,buff=new Array(n),copyInt_(buff,t),buff}function str2bigInt(t,r,e){var n,i,o,s,h,a=t.length;if(-1==r){for(o=new Array(0);;){for(s=new Array(o.length+1),i=0;i<o.length;i++)s[i+1]=o[i];if(s[0]=parseInt(t,10),o=s,n=t.indexOf(",",0),1>n)break;if(t=t.substring(n+1),0==t.length)break}return o.length<e?(s=new Array(e),copy_(s,o),s):o}for(o=int2bigInt(0,r*a,0),i=0;a>i&&(n=digitsStr.indexOf(t.substring(i,i+1),0),36>=r&&n>=36&&(n-=26),!(n>=r||0>n));i++)multInt_(o,r),addInt_(o,n);for(a=o.length;a>0&&!o[a-1];a--);for(a=e>a+1?e:a+1,s=new Array(a),h=a<o.length?a:o.length,i=0;h>i;i++)s[i]=o[i];for(;a>i;i++)s[i]=0;return s}function equalsInt(t,r){var e;if(t[0]!=r)return 0;for(e=1;e<t.length;e++)if(t[e])return 0;return 1}function equals(t,r){var e,n=t.length<r.length?t.length:r.length;for(e=0;n>e;e++)if(t[e]!=r[e])return 0;if(t.length>r.length){for(;e<t.length;e++)if(t[e])return 0}else for(;e<r.length;e++)if(r[e])return 0;return 1}function isZero(t){var r;for(r=0;r<t.length;r++)if(t[r])return 0;return 1}function bigInt2str(t,r){var e,n,i="";if(s6.length!=t.length?s6=dup(t):copy_(s6,t),-1==r){for(e=t.length-1;e>0;e--)i+=t[e]+",";i+=t[0]}else for(;!isZero(s6);)n=divInt_(s6,r),i=digitsStr.substring(n,n+1)+i;return 0==i.length&&(i="0"),i}function dup(t){return buff=new Array(t.length),copy_(buff,t),buff}function copy_(t,r){var e,n=t.length<r.length?t.length:r.length;for(e=0;n>e;e++)t[e]=r[e];for(e=n;e<t.length;e++)t[e]=0}function copyInt_(t,r){var e,n;for(n=r,e=0;e<t.length;e++)t[e]=n&mask,n>>=bpe}function addInt_(t,r){var e,n,i,o;for(t[0]+=r,n=t.length,i=0,e=0;n>e;e++)if(i+=t[e],o=0,0>i&&(o=-(i>>bpe),i+=o*radix),t[e]=i&mask,i=(i>>bpe)-o,!i)return}function rightShift_(t,r){var e,n=Math.floor(r/bpe);if(n){for(e=0;e<t.length-n;e++)t[e]=t[e+n];for(;e<t.length;e++)t[e]=0;r%=bpe}for(e=0;e<t.length-1;e++)t[e]=mask&(t[e+1]<<bpe-r|t[e]>>r);t[e]>>=r}function halve_(t){var r;for(r=0;r<t.length-1;r++)t[r]=mask&(t[r+1]<<bpe-1|t[r]>>1);t[r]=t[r]>>1|t[r]&radix>>1}function leftShift_(t,r){var e,n=Math.floor(r/bpe);if(n){for(e=t.length;e>=n;e--)t[e]=t[e-n];for(;e>=0;e--)t[e]=0;r%=bpe}if(r){for(e=t.length-1;e>0;e--)t[e]=mask&(t[e]<<r|t[e-1]>>bpe-r);t[e]=mask&t[e]<<r}}function multInt_(t,r){var e,n,i,o;if(r)for(n=t.length,i=0,e=0;n>e;e++)i+=t[e]*r,o=0,0>i&&(o=-(i>>bpe),i+=o*radix),t[e]=i&mask,i=(i>>bpe)-o}function divInt_(t,r){var e,n,i=0;for(e=t.length-1;e>=0;e--)n=i*radix+t[e],t[e]=Math.floor(n/r),i=n%r;return i}function linComb_(t,r,e,n){var i,o,s,h;for(s=t.length<r.length?t.length:r.length,h=t.length,o=0,i=0;s>i;i++)o+=e*t[i]+n*r[i],t[i]=o&mask,o>>=bpe;for(i=s;h>i;i++)o+=e*t[i],t[i]=o&mask,o>>=bpe}function linCombShift_(t,r,e,n){var i,o,s,h;for(s=t.length<n+r.length?t.length:n+r.length,h=t.length,o=0,i=n;s>i;i++)o+=t[i]+e*r[i-n],t[i]=o&mask,o>>=bpe;for(i=s;o&&h>i;i++)o+=t[i],t[i]=o&mask,o>>=bpe}function addShift_(t,r,e){var n,i,o,s;for(o=t.length<e+r.length?t.length:e+r.length,s=t.length,i=0,n=e;o>n;n++)i+=t[n]+r[n-e],t[n]=i&mask,i>>=bpe;for(n=o;i&&s>n;n++)i+=t[n],t[n]=i&mask,i>>=bpe}function subShift_(t,r,e){var n,i,o,s;for(o=t.length<e+r.length?t.length:e+r.length,s=t.length,i=0,n=e;o>n;n++)i+=t[n]-r[n-e],t[n]=i&mask,i>>=bpe;for(n=o;i&&s>n;n++)i+=t[n],t[n]=i&mask,i>>=bpe}function sub_(t,r){var e,n,i;for(i=t.length<r.length?t.length:r.length,n=0,e=0;i>e;e++)n+=t[e]-r[e],t[e]=n&mask,n>>=bpe;for(e=i;n&&e<t.length;e++)n+=t[e],t[e]=n&mask,n>>=bpe}function add_(t,r){var e,n,i;for(i=t.length<r.length?t.length:r.length,n=0,e=0;i>e;e++)n+=t[e]+r[e],t[e]=n&mask,n>>=bpe;for(e=i;n&&e<t.length;e++)n+=t[e],t[e]=n&mask,n>>=bpe}function mult_(t,r){var e;for(ss.length!=2*t.length&&(ss=new Array(2*t.length)),copyInt_(ss,0),e=0;e<r.length;e++)r[e]&&linCombShift_(ss,t,r[e],e);copy_(t,ss)}function mod_(t,r){s4.length!=t.length?s4=dup(t):copy_(s4,t),s5.length!=t.length&&(s5=dup(t)),divide_(s4,r,s5,t)}function multMod_(t,r,e){var n;for(s0.length!=2*t.length&&(s0=new Array(2*t.length)),copyInt_(s0,0),n=0;n<r.length;n++)r[n]&&linCombShift_(s0,t,r[n],n);mod_(s0,e),copy_(t,s0)}function squareMod_(t,r){var e,n,i,o,s;for(o=t.length;o>0&&!t[o-1];o--);for(s=o>r.length?2*o:2*r.length,s0.length!=s&&(s0=new Array(s)),copyInt_(s0,0),e=0;o>e;e++){for(i=s0[2*e]+t[e]*t[e],s0[2*e]=i&mask,i>>=bpe,n=e+1;o>n;n++)i=s0[e+n]+2*t[e]*t[n]+i,s0[e+n]=i&mask,i>>=bpe;s0[e+o]=i}mod_(s0,r),copy_(t,s0)}function trim(t,r){var e,n;for(e=t.length;e>0&&!t[e-1];e--);return n=new Array(e+r),copy_(n,t),n}function powMod_(t,r,e){var n,i,o,s;if(s7.length!=e.length&&(s7=dup(e)),0!=(1&e[0])){for(copyInt_(s7,0),o=e.length;o>0&&!e[o-1];o--);for(s=radix-inverseModInt(modInt(e,radix),radix),s7[o]=1,multMod_(t,s7,e),s3.length!=t.length?s3=dup(t):copy_(s3,t),n=r.length-1;n>0&!r[n];n--);if(0==r[n])return copyInt_(t,1),void 0;for(i=1<<bpe-1;i&&!(r[n]&i);i>>=1);for(;;){if(!(i>>=1)){if(n--,0>n)return mont_(t,one,e,s),void 0;i=1<<bpe-1}mont_(t,t,e,s),i&r[n]&&mont_(t,s3,e,s)}}else for(copy_(s7,t),copyInt_(t,1);!equalsInt(r,0);)1&r[0]&&multMod_(t,s7,e),divInt_(r,2),squareMod_(s7,e)}function mont_(t,r,e,n){var i,o,s,h,a,u,g=e.length,p=r.length;for(sa.length!=g&&(sa=new Array(g)),copyInt_(sa,0);g>0&&0==e[g-1];g--);for(;p>0&&0==r[p-1];p--);for(u=sa.length-1,i=0;g>i;i++){for(a=sa[0]+t[i]*r[0],h=(a&mask)*n&mask,s=a+h*e[0]>>bpe,a=t[i],o=1;p-4>o;)s+=sa[o]+h*e[o]+a*r[o],sa[o-1]=s&mask,s>>=bpe,o++,s+=sa[o]+h*e[o]+a*r[o],sa[o-1]=s&mask,s>>=bpe,o++,s+=sa[o]+h*e[o]+a*r[o],sa[o-1]=s&mask,s>>=bpe,o++,s+=sa[o]+h*e[o]+a*r[o],sa[o-1]=s&mask,s>>=bpe,o++,s+=sa[o]+h*e[o]+a*r[o],sa[o-1]=s&mask,s>>=bpe,o++;for(;p>o;)s+=sa[o]+h*e[o]+a*r[o],sa[o-1]=s&mask,s>>=bpe,o++;for(;g-4>o;)s+=sa[o]+h*e[o],sa[o-1]=s&mask,s>>=bpe,o++,s+=sa[o]+h*e[o],sa[o-1]=s&mask,s>>=bpe,o++,s+=sa[o]+h*e[o],sa[o-1]=s&mask,s>>=bpe,o++,s+=sa[o]+h*e[o],sa[o-1]=s&mask,s>>=bpe,o++,s+=sa[o]+h*e[o],sa[o-1]=s&mask,s>>=bpe,o++;for(;g>o;)s+=sa[o]+h*e[o],sa[o-1]=s&mask,s>>=bpe,o++;for(;u>o;)s+=sa[o],sa[o-1]=s&mask,s>>=bpe,o++;sa[o-1]=s&mask}greater(e,sa)||sub_(sa,e),copy_(t,sa)}var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr="0".charCodeAt(0),vv=0;9>=vv;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;
for(rr="A".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];for(BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare,RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt,RSAKey.prototype.doPrivate=RSADoPrivate,RSAKey.prototype.setPrivate=RSASetPrivate,RSAKey.prototype.setPrivateEx=RSASetPrivateEx,RSAKey.prototype.generate=RSAGenerate,RSAKey.prototype.decrypt=RSADecrypt,bpe=0,mask=0,radix=mask+1,digitsStr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_=!@#$%^&*()[]{}|;:,.<>/?`~ \\'\"+-",bpe=0;1<<bpe+1>1<<bpe;bpe++);bpe>>=1,mask=(1<<bpe)-1,radix=mask+1,one=int2bigInt(1,1,1),t=new Array(0),ss=t,s0=t,s1=t,s2=t,s3=t,s4=t,s5=t,s6=t,s7=t,T=t,sa=t,mr_x1=t,mr_r=t,mr_a=t,eg_v=t,eg_u=t,eg_A=t,eg_B=t,eg_C=t,eg_D=t,md_q1=t,md_q2=t,md_q3=t,md_r=t,md_r1=t,md_r2=t,md_tt=t,primes=t,pows=t,s_i=t,s_i2=t,s_R=t,s_rm=t,s_q=t,s_n1=t,s_a=t,s_r2=t,s_n=t,s_b=t,s_d=t,s_x1=t,s_x2=t,s_aa=t,rpprb=t;
"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),"function"==typeof define&&define([],function(){return sjcl}),sjcl.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,i,r,n,o,s=this._tables[0][4],c=this._tables[1],a=t.length,h=1;if(4!==a&&6!==a&&8!==a)throw new sjcl.exception.invalid("invalid aes key size");for(this._key=[n=t.slice(0),o=[]],e=a;4*a+28>e;e++)r=n[e-1],(e%a===0||8===a&&e%a===4)&&(r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[255&r],e%a===0&&(r=r<<8^r>>>24^h<<24,h=h<<1^283*(h>>7))),n[e]=n[e-a]^r;for(i=0;e;i++,e--)r=n[3&i?e:e-4],o[i]=4>=e||4>i?r:c[0][s[r>>>24]]^c[1][s[r>>16&255]]^c[2][s[r>>8&255]]^c[3][s[255&r]]},sjcl.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,e,i,r,n,o,s,c,a,h=this._tables[0],l=this._tables[1],u=h[4],f=l[4],d=[],_=[];for(t=0;256>t;t++)_[(d[t]=t<<1^283*(t>>7))^t]=t;for(e=i=0;!u[e];e^=r||1,i=_[i]||1)for(s=i^i<<1^i<<2^i<<3^i<<4,s=s>>8^255&s^99,u[e]=s,f[s]=e,o=d[n=d[r=d[e]]],a=16843009*o^65537*n^257*r^16843008*e,c=257*d[s]^16843008*s,t=0;4>t;t++)h[t][e]=c=c<<24^c>>>8,l[t][s]=a=a<<24^a>>>8;for(t=0;5>t;t++)h[t]=h[t].slice(0),l[t]=l[t].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new sjcl.exception.invalid("invalid aes block size");var i,r,n,o,s=this._key[e],c=t[0]^s[0],a=t[e?3:1]^s[1],h=t[2]^s[2],l=t[e?1:3]^s[3],u=s.length/4-2,f=4,d=[0,0,0,0],_=this._tables[e],p=_[0],g=_[1],b=_[2],y=_[3],m=_[4];for(o=0;u>o;o++)i=p[c>>>24]^g[a>>16&255]^b[h>>8&255]^y[255&l]^s[f],r=p[a>>>24]^g[h>>16&255]^b[l>>8&255]^y[255&c]^s[f+1],n=p[h>>>24]^g[l>>16&255]^b[c>>8&255]^y[255&a]^s[f+2],l=p[l>>>24]^g[c>>16&255]^b[a>>8&255]^y[255&h]^s[f+3],f+=4,c=i,a=r,h=n;for(o=0;4>o;o++)d[e?3&-o:o]=m[c>>>24]<<24^m[a>>16&255]<<16^m[h>>8&255]<<8^m[255&l]^s[f++],i=c,c=a,a=h,h=l,l=i;return d}},sjcl.bitArray={bitSlice:function(t,e,i){return t=sjcl.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===i?t:sjcl.bitArray.clamp(t,i-e)},extract:function(t,e,i){var r,n=Math.floor(-e-i&31);return r=-32&(e+i-1^e)?t[e/32|0]<<32-n^t[e/32+1|0]>>>n:t[e/32|0]>>>n,r&(1<<i)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var i=t[t.length-1],r=sjcl.bitArray.getPartial(i);return 32===r?t.concat(e):sjcl.bitArray._shiftRight(e,r,0|i,t.slice(0,t.length-1))},bitLength:function(t){var e,i=t.length;return 0===i?0:(e=t[i-1],32*(i-1)+sjcl.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;t=t.slice(0,Math.ceil(e/32));var i=t.length;return e=31&e,i>0&&e&&(t[i-1]=sjcl.bitArray.partial(e,t[i-1]&2147483648>>e-1,1)),t},partial:function(t,e,i){return 32===t?e:(i?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(sjcl.bitArray.bitLength(t)!==sjcl.bitArray.bitLength(e))return!1;var i,r=0;for(i=0;i<t.length;i++)r|=t[i]^e[i];return 0===r},_shiftRight:function(t,e,i,r){var n,o,s=0;for(void 0===r&&(r=[]);e>=32;e-=32)r.push(i),i=0;if(0===e)return r.concat(t);for(n=0;n<t.length;n++)r.push(i|t[n]>>>e),i=t[n]<<32-e;return s=t.length?t[t.length-1]:0,o=sjcl.bitArray.getPartial(s),r.push(sjcl.bitArray.partial(e+o&31,e+o>32?i:r.pop(),1)),r},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]},byteswapM:function(t){var e,i,r=65280;for(e=0;e<t.length;++e)i=t[e],t[e]=i>>>24|i>>>8&r|(i&r)<<8|i<<24;return t}},sjcl.codec.utf8String={fromBits:function(t){var e,i,r="",n=sjcl.bitArray.bitLength(t);for(e=0;n/8>e;e++){0===(3&e)&&(i=t[e/4]);var o=i>>>24;r+=String.fromCharCode(Number(String(o))),i<<=8}return decodeURIComponent(escape(r))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,i=[],r=0;for(e=0;e<t.length;e++)r=r<<8|t.charCodeAt(e),3===(3&e)&&(i.push(r),r=0);return 3&e&&i.push(sjcl.bitArray.partial(8*(3&e),r)),i}},sjcl.codec.hex={fromBits:function(t){var e,i="";for(e=0;e<t.length;e++)i+=((0|t[e])+0xf00000000000).toString(16).substr(4);return i.substr(0,sjcl.bitArray.bitLength(t)/4)},toBits:function(t){var e,i,r=[];for(t=t.replace(/\s|0x/g,""),i=t.length,t+="00000000",e=0;e<t.length;e+=8)r.push(0^parseInt(t.substr(e,8),16));return sjcl.bitArray.clamp(r,4*i)}},sjcl.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,i){var r,n="",o=0,s=sjcl.codec.base64._chars,c=0,a=sjcl.bitArray.bitLength(t);for(i&&(s=s.substr(0,62)+"-_"),r=0;6*n.length<a;)n+=s.charAt((c^t[r]>>>o)>>>26),6>o?(c=t[r]<<6-o,o+=26,r++):(c<<=6,o-=6);for(;3&n.length&&!e;)n+="=";return n},toBits:function(t,e){t=t.replace(/\s|=/g,"");var i,r,n=[],o=0,s=sjcl.codec.base64._chars,c=0;for(e&&(s=s.substr(0,62)+"-_"),i=0;i<t.length;i++){if(r=s.indexOf(t.charAt(i)),0>r)throw new sjcl.exception.invalid("this isn't base64!");o>26?(o-=26,n.push(c^r>>>o),c=r<<32-o):(o+=6,c^=r<<32-o)}return 56&o&&n.push(sjcl.bitArray.partial(56&o,c,1)),n}},sjcl.codec.base64url={fromBits:function(t){return sjcl.codec.base64.fromBits(t,1,1)},toBits:function(t){return sjcl.codec.base64.toBits(t,1)}},sjcl.codec.bytes={fromBits:function(t){var e,i,r=[],n=sjcl.bitArray.bitLength(t);for(e=0;n/8>e;e++)0===(3&e)&&(i=t[e/4]),r.push(i>>>24),i<<=8;return r},toBits:function(t){var e,i=[],r=0;for(e=0;e<t.length;e++)r=r<<8|t[e],3===(3&e)&&(i.push(r),r=0);return 3&e&&i.push(sjcl.bitArray.partial(8*(3&e),r)),i}},sjcl.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},sjcl.hash.sha256.hash=function(t){return(new sjcl.hash.sha256).update(t).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t));var e,i=this._buffer=sjcl.bitArray.concat(this._buffer,t),r=this._length,n=this._length=r+sjcl.bitArray.bitLength(t);for(e=512+r&-512;n>=e;e+=512)this._block(i.splice(0,16));return this},finalize:function(){var t,e=this._buffer,i=this._h;for(e=sjcl.bitArray.concat(e,[sjcl.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),i},_init:[],_key:[],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,i=0,r=2;t:for(;64>i;r++){for(e=2;r>=e*e;e++)if(r%e===0)continue t;8>i&&(this._init[i]=t(Math.pow(r,.5))),this._key[i]=t(Math.pow(r,1/3)),i++}},_block:function(t){var e,i,r,n,o=t.slice(0),s=this._h,c=this._key,a=s[0],h=s[1],l=s[2],u=s[3],f=s[4],d=s[5],_=s[6],p=s[7];for(e=0;64>e;e++)16>e?i=o[e]:(r=o[e+1&15],n=o[e+14&15],i=o[15&e]=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+o[15&e]+o[e+9&15]|0),i=i+p+(f>>>6^f>>>11^f>>>25^f<<26^f<<21^f<<7)+(_^f&(d^_))+c[e],p=_,_=d,d=f,f=u+i|0,u=l,l=h,h=a,a=i+(h&l^u&(h^l))+(h>>>2^h>>>13^h>>>22^h<<30^h<<19^h<<10)|0;s[0]=s[0]+a|0,s[1]=s[1]+h|0,s[2]=s[2]+l|0,s[3]=s[3]+u|0,s[4]=s[4]+f|0,s[5]=s[5]+d|0,s[6]=s[6]+_|0,s[7]=s[7]+p|0}},void 0===sjcl.beware&&(sjcl.beware={}),sjcl.mode.cbc={name:"cbc",encrypt:function(t,e,i,r,n){if(r&&r.length)throw new sjcl.exception.invalid("cbc can't authenticate data");if(128!==sjcl.bitArray.bitLength(i))throw new sjcl.exception.invalid("cbc iv must be 128 bits");var o,s=sjcl.bitArray,c=s._xor4,a=s.bitLength(e),h=0,l=[];if(7&a)throw new sjcl.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(o=0;a>=h+128;o+=4,h+=128)i=t.encrypt(c(i,e.slice(o,o+4))),l.splice(o,0,i[0],i[1],i[2],i[3]);return n&&(a=16843009*(16-(a>>3&15)),i=t.encrypt(c(i,s.concat(e,[a,a,a,a]).slice(o,o+4))),l.splice(o,0,i[0],i[1],i[2],i[3])),l},decrypt:function(t,e,i,r,n){if(r&&r.length)throw new sjcl.exception.invalid("cbc can't authenticate data");if(128!==sjcl.bitArray.bitLength(i))throw new sjcl.exception.invalid("cbc iv must be 128 bits");if(127&sjcl.bitArray.bitLength(e)||!e.length)throw new sjcl.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var o,s,c,a=sjcl.bitArray,h=a._xor4,l=[];for(r=r||[],o=0;o<e.length;o+=4)s=e.slice(o,o+4),c=h(i,t.decrypt(s)),l.splice(o,0,c[0],c[1],c[2],c[3]),i=s;if(n){if(s=255&l[o-1],0===s||s>16)throw new sjcl.exception.corrupt("pkcs#5 padding corrupt");if(c=16843009*s,!a.equal(a.bitSlice([c,c,c,c],0,8*s),a.bitSlice(l,32*l.length-8*s,32*l.length)))throw new sjcl.exception.corrupt("pkcs#5 padding corrupt");return a.bitSlice(l,0,32*l.length-8*s)}return l}},sjcl.mode.gcm={name:"gcm",encrypt:function(t,e,i,r,n){var o,s=e.slice(0),c=sjcl.bitArray;return n=n||128,r=r||[],o=sjcl.mode.gcm._ctrMode(!0,t,s,r,i,n),c.concat(o.data,o.tag)},decrypt:function(t,e,i,r,n){var o,s,c=e.slice(0),a=sjcl.bitArray,h=a.bitLength(c);if(n=n||128,r=r||[],h>=n?(s=a.bitSlice(c,h-n),c=a.bitSlice(c,0,h-n)):(s=c,c=[]),o=sjcl.mode.gcm._ctrMode(!1,t,c,r,i,n),!a.equal(o.tag,s))throw new sjcl.exception.corrupt("gcm: tag doesn't match");return o.data},_galoisMultiply:function(t,e){var i,r,n,o,s,c,a=sjcl.bitArray,h=a._xor4;for(o=[0,0,0,0],s=e.slice(0),i=0;128>i;i++){for(n=0!==(t[Math.floor(i/32)]&1<<31-i%32),n&&(o=h(o,s)),c=0!==(1&s[3]),r=3;r>0;r--)s[r]=s[r]>>>1|(1&s[r-1])<<31;s[0]=s[0]>>>1,c&&(s[0]=s[0]^225<<24)}return o},_ghash:function(t,e,i){var r,n,o=i.length;for(r=e.slice(0),n=0;o>n;n+=4)r[0]^=4294967295&i[n],r[1]^=4294967295&i[n+1],r[2]^=4294967295&i[n+2],r[3]^=4294967295&i[n+3],r=sjcl.mode.gcm._galoisMultiply(r,t);return r},_ctrMode:function(t,e,i,r,n,o){var s,c,a,h,l,u,f,d,_,p,g,b,y=sjcl.bitArray;for(_=i.length,p=y.bitLength(i),g=y.bitLength(r),b=y.bitLength(n),s=e.encrypt([0,0,0,0]),96===b?(c=n.slice(0),c=y.concat(c,[1])):(c=sjcl.mode.gcm._ghash(s,[0,0,0,0],n),c=sjcl.mode.gcm._ghash(s,c,[0,0,Math.floor(b/4294967296),4294967295&b])),a=sjcl.mode.gcm._ghash(s,[0,0,0,0],r),u=c.slice(0),f=a.slice(0),t||(f=sjcl.mode.gcm._ghash(s,a,i)),l=0;_>l;l+=4)u[3]++,h=e.encrypt(u),i[l]^=h[0],i[l+1]^=h[1],i[l+2]^=h[2],i[l+3]^=h[3];return i=y.clamp(i,p),t&&(f=sjcl.mode.gcm._ghash(s,a,i)),d=[Math.floor(g/4294967296),4294967295&g,Math.floor(p/4294967296),4294967295&p],f=sjcl.mode.gcm._ghash(s,f,d),h=e.encrypt(c),f[0]^=h[0],f[1]^=h[1],f[2]^=h[2],f[3]^=h[3],{tag:y.bitSlice(f,0,o),data:i}}},sjcl.misc.hmac=function(t,e){this._hash=e=e||sjcl.hash.sha256;var i,r=[[],[]],n=e.prototype.blockSize/32;for(this._baseHash=[new e,new e],t.length>n&&(t=e.hash(t)),i=0;n>i;i++)r[0][i]=909522486^t[i],r[1][i]=1549556828^t[i];this._baseHash[0].update(r[0]),this._baseHash[1].update(r[1]),this._resultHash=new e(this._baseHash[0])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(t){if(this._updated)throw new sjcl.exception.invalid("encrypt on already updated hmac called!");return this.update(t),this.digest(t)},sjcl.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},sjcl.misc.hmac.prototype.update=function(t){this._updated=!0,this._resultHash.update(t)},sjcl.misc.hmac.prototype.digest=function(){var t=this._resultHash.finalize(),e=new this._hash(this._baseHash[1]).update(t).finalize();return this.reset(),e},sjcl.prng=function(t){this._pools=[new sjcl.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=t,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},sjcl.prng.prototype={randomWords:function(t,e){var i,r,n=[],o=this.isReady(e);if(o===this._NOT_READY)throw new sjcl.exception.notReady("generator isn't seeded");for(o&this._REQUIRES_RESEED&&this._reseedFromPools(!(o&this._READY)),i=0;t>i;i+=4)(i+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),r=this._gen4words(),n.push(r[0],r[1],r[2],r[3]);return this._gate(),n.slice(0,t)},setDefaultParanoia:function(t,e){if(0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=t},addEntropy:function(t,e,i){i=i||"user";var r,n,o,s,c=(new Date).valueOf(),a=this._robins[i],h=(this.isReady(),0);switch(r=this._collectorIds[i],void 0===r&&(r=this._collectorIds[i]=this._collectorIdNext++),void 0===a&&(a=this._robins[i]=0),this._robins[i]=(this._robins[i]+1)%this._pools.length,typeof t){case"number":void 0===e&&(e=1),this._pools[a].update([r,this._eventId++,1,e,c,1,0|t]);break;case"object":if(s=Object.prototype.toString.call(t),"[object Uint32Array]"===s){for(o=[],n=0;n<t.length;n++)o.push(t[n]);t=o}else for("[object Array]"!==s&&(h=1),n=0;n<t.length&&!h;n++)"number"!=typeof t[n]&&(h=1);if(!h){if(void 0===e)for(e=0,n=0;n<t.length;n++)for(o=t[n];o>0;)e++,o>>>=1;this._pools[a].update([r,this._eventId++,2,e,c,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this._pools[a].update([r,this._eventId++,3,e,c,t.length]),this._pools[a].update(t);break;default:h=1}if(h)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[a]+=e,this._poolStrength+=e},isReady:function(t){var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){var e=this._PARANOIA_LEVELS[t?t:this._defaultParanoia];return this._strength>=e?1:this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector),touchCollector:this._bind(this._touchCollector)},window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.addEventListener("touchmove",this._eventListener.touchCollector,!1);else{if(!document.attachEvent)throw new sjcl.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.removeEventListener("touchmove",this._eventListener.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var i,r,n=this._callbacks[t],o=[];for(r in n)n.hasOwnProperty(r)&&n[r]===e&&o.push(r);for(i=0;i<o.length;i++)r=o[i],delete n[r]},_bind:function(t){var e=this;return function(){t.apply(e,arguments)}},_gen4words:function(){for(var t=0;4>t&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new sjcl.cipher.aes(this._key)},_reseed:function(t){this._key=sjcl.hash.sha256.hash(this._key.concat(t)),this._cipher=new sjcl.cipher.aes(this._key);for(var e=0;4>e&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,i=[],r=0;for(this._nextReseed=i[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,e=0;16>e;e++)i.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(i=i.concat(this._pools[e].finalize()),r+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new sjcl.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=r,r>this._strength&&(this._strength=r),this._reseedCount++,this._reseed(i)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(t){var e,i;try{e=t.x||t.clientX||t.offsetX||0,i=t.y||t.clientY||t.offsetY||0}catch(r){e=0,i=0}0!=e&&0!=i&&sjcl.random.addEntropy([e,i],2,"mouse"),this._addCurrentTimeToEntropy(0)},_touchCollector:function(t){var e=t.touches[0]||t.changedTouches[0],i=e.pageX||e.clientX,r=e.pageY||e.clientY;sjcl.random.addEntropy([i,r],1,"touch"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?sjcl.random.addEntropy(window.performance.now(),t,"loadtime"):sjcl.random.addEntropy((new Date).valueOf(),t,"loadtime")},_accelerometerCollector:function(t){var e=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z;if(window.orientation){var i=window.orientation;"number"==typeof i&&sjcl.random.addEntropy(i,1,"accelerometer")}e&&sjcl.random.addEntropy(e,2,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(t,e){var i,r=sjcl.random._callbacks[t],n=[];for(i in r)r.hasOwnProperty(i)&&n.push(r[i]);for(i=0;i<n.length;i++)n[i](e)}},"undefined"==typeof ArrayBuffer&&!function(t){t.ArrayBuffer=function(){},t.DataView=function(){}}(this),sjcl.codec.arrayBuffer={fromBits:function(t,e,i){var r,n,o,s,c;if(e=void 0==e?!0:e,i=i||8,0===t.length)return new ArrayBuffer(0);if(o=sjcl.bitArray.bitLength(t)/8,sjcl.bitArray.bitLength(t)%8!==0)throw new sjcl.exception.invalid("Invalid bit size, must be divisble by 8 to fit in an arraybuffer correctly");for(e&&o%i!==0&&(o+=i-o%i),s=new DataView(new ArrayBuffer(4*t.length)),n=0;n<t.length;n++)s.setUint32(4*n,t[n]<<32);if(r=new DataView(new ArrayBuffer(o)),r.byteLength===s.byteLength)return s.buffer;for(c=s.byteLength<r.byteLength?s.byteLength:r.byteLength,n=0;c>n;n++)r.setUint8(n,s.getUint8(n));return r.buffer},toBits:function(t){var e,i,r,n,o=[];if(0===t.byteLength)return[];r=new DataView(t),i=r.byteLength-r.byteLength%4;for(var e=0;i>e;e+=4)o.push(r.getUint32(e));if(r.byteLength%4!=0){n=new DataView(new ArrayBuffer(4));for(var e=0,s=r.byteLength%4;s>e;e++)n.setUint8(e+4-s,r.getUint8(i+e));o.push(sjcl.bitArray.partial(r.byteLength%4*8,n.getUint32(0)))}return o},hexDumpBuffer:function(t){for(var e=new DataView(t),i="",r=function(t,e){return t+="",t.length>=e?t:new Array(e-t.length+1).join("0")+t},n=0;n<e.byteLength;n+=2)n%16==0&&(i+="\n"+n.toString(16)+"	"),i+=r(e.getUint16(n).toString(16),4)+" ";void 0===typeof console&&(console=console||{log:function(){}}),console.log(i.toUpperCase())}};
"use strict";tutao.provide("SecureRandom");var SecureRandom=function(){};SecureRandom._nextBytes=[],SecureRandom.prototype.nextBytes=function(e){if(SecureRandom._nextBytes.length<e.length)throw new Error("SecureRandom does not have random numbers.");for(var n=SecureRandom._nextBytes.splice(0,e.length),t=0;t<e.length;t++)e[t]=n[t]},SecureRandom.setNextRandomBytes=function(e){SecureRandom._nextBytes=e};
"use strict";tutao.provide("tutao.crypto.Oaep"),tutao.crypto.Oaep=function(){this.utils=new tutao.crypto.Utils},tutao.crypto.Oaep.prototype.pad=function(t,e,r){var n=32;if(r.length!=n)throw new Error("invalid seed length: "+r.length+". expected: "+n+" bytes!");if(t.length>e/8-n-1)throw new Error("invalid value length: "+t.length+". expected: max. "+(e/8-n-1));for(var l=this._getPSBlock(t,e),o=this.utils.mgf1(r,l.length-n),h=n;h<l.length;h++)l[h]^=o[h-n];for(var a=this.utils.mgf1(l.slice(n,l.length),n),h=0;h<a.length;h++)l[h]=r[h]^a[h];return l},tutao.crypto.Oaep.prototype.unpad=function(t,e){var r=32;if(t.length!=e/8-1)throw new Error("invalid value length: "+t.length+". expected: "+(e/8-1)+" bytes!");var n=this.utils.mgf1(t.slice(r,t.length),r),l=[];l.length=r;for(var o=0;o<n.length;o++)l[o]=t[o]^n[o];for(var h=this.utils.mgf1(l,t.length-r),o=r;o<t.length;o++)t[o]^=h[o-r];for(var a=2*r;a<t.length&&1!=t[a];a++)if(0!=t[a]||a==t.length)throw new Error("invalid padding");return t.slice(a+1,t.length)},tutao.crypto.Oaep.prototype._getPSBlock=function(t,e){var r=32,n=e/8-1,l=[];l.length=n;var o=new sjcl.hash.sha256;o.update([]);for(var h=sjcl.codec.bytes.fromBits(o.finalize()),a=l.length-(1+t.length),i=0;i<l.length;i++)l[i]=i>=r&&2*r>i?h[i-r]:a>i?0:i==a?1:t[i-a-1];return l};
"use strict";tutao.provide("tutao.crypto.Pss"),tutao.crypto.Pss=function(){this.utils=new tutao.crypto.Utils},tutao.crypto.Pss.prototype.encode=function(t,e,s){var r=32,o=Math.ceil(e/8);if(s.length!=r)throw new Error("invalid salt length: "+s.length+". expected: "+r+" bytes!");var c=r+s.length+2;if(c>o)throw new Error("invalid hash/salt length: "+c+". expected: max. "+o);var a=e-1,h=8*r+8*s.length+9;if(h>a)throw new Error("invalid maximum emBits length. Was "+a+", expected: "+h);var i=sjcl.codec.bytes.fromBits(sjcl.hash.sha256.hash(sjcl.codec.bytes.toBits(t))),l=[0,0,0,0,0,0,0,0].concat(i,s),n=sjcl.codec.bytes.fromBits(sjcl.hash.sha256.hash(sjcl.codec.bytes.toBits(l))),f=[];f.length=o-s.length-r-2;for(var d=0;d<f.length;d++)f[d]=0;var g=f.concat([1],s);this._clear(f);var u=o-r-1;if(g.length!=u)throw new Error("unexpected length of block: "+g.length+". Expected: "+u);for(var y=this.utils.mgf1(n,o-n.length-1),w=[],d=0;d<y.length;d++)w[d]=g[d]^y[d];this._clear(g),w[0]&=255>>8*o-a;var v=w.concat(n,[188]);return this._clear(w),v},tutao.crypto.Pss.prototype.verify=function(t,e,s){var r=32,o=r,c=Math.ceil(s/8),a=r+o+2;try{if(e.length<a)throw new Error("invalid length of encoded message: "+e.length+". expected: > "+a+" bytes!");if(188!=e[e.length-1])throw new Error("rightmost octet of EM must be 188 (0xbc) but was "+e[e.length-1]);var h=e.slice(0,c-r-1),i=e.slice(c-r-1,c-r-1+r);if(h[0]>>8-(8*c-s)!=0)throw new Error("inconsistent leftmost octet in maskedDB.");for(var l=this.utils.mgf1(i,c-r-1),n=[],f=0;f<l.length;f++)n[f]=h[f]^l[f];n[0]&=255>>8*c-s;for(var f=1;c-r-o-2>f;f++)if(0!=n[f])throw new Error("inconsistent leftmost octets of db.");if(1!=n[c-r-o-1])throw new Error("inconsistent octet value in db. Expected 1 (0x01) but was "+n[c-r-o-1]);var d=n.slice(n.length-o),g=sjcl.codec.bytes.fromBits(sjcl.hash.sha256.hash(sjcl.codec.bytes.toBits(t))),u=[0,0,0,0,0,0,0,0].concat(g,d),y=sjcl.codec.bytes.fromBits(sjcl.hash.sha256.hash(sjcl.codec.bytes.toBits(u)));if(!tutao.util.ArrayUtils.arrayEquals(i,y))throw new Error("Hashes do not match")}finally{this._clear(t),this._clear(e),this._clear(h),this._clear(i),this._clear(l),this._clear(n),this._clear(d),this._clear(g),this._clear(u),this._clear(y)}},tutao.crypto.Pss.prototype._clear=function(t){if(t)for(var e=0;e<t.length;e++)t[e]=0};
"use strict";tutao.provide("tutao.crypto.Utils"),tutao.crypto.Utils=function(){},tutao.crypto.Utils.prototype.mgf1=function(t,r){var o=null,e=0,i=new sjcl.hash.sha256,n=[],a=sjcl.codec.bytes.toBits(t);do{o=this.i2osp(e);var c=sjcl.codec.bytes.toBits(o);i.update(a),i.update(c),n=sjcl.bitArray.concat(n,i.finalize())}while(++e<Math.ceil(r/32));var u=sjcl.bitArray.bitSlice(n,0,8*r);return sjcl.codec.bytes.fromBits(u)},tutao.crypto.Utils.prototype.i2osp=function(t){var r=[];return r.push(t>>24&255),r.push(t>>16&255),r.push(t>>8&255),r.push(t>>0&255),r},tutao.crypto.Utils.PADDING_BLOCK_LENGTH=16,tutao.crypto.Utils.pad=function(t){var r=tutao.crypto.Utils.PADDING_BLOCK_LENGTH-t.byteLength%tutao.crypto.Utils.PADDING_BLOCK_LENGTH,o=new Uint8Array(r);return o.fill(r),tutao.crypto.Utils.concat(t,o)},tutao.crypto.Utils.unpad=function(t){var r=t[t.byteLength-1];if(0==r||r>t.byteLength||r>tutao.crypto.Utils.PADDING_BLOCK_LENGTH)throw new tutao.crypto.CryptoError("invalid padding: "+r);var o=t.byteLength-r,e=new Uint8Array(o);return e.set(t.subarray(0,o)),e},tutao.crypto.Utils.concat=function(t,r){var o=new Uint8Array(t.byteLength+r.byteLength);return o.set(t,0),o.set(r,t.byteLength),o},tutao.crypto.Utils.createAuthVerifier=function(t){return tutao.util.EncodingConverter.uint8ArrayToBase64(tutao.locator.shaCrypter.hash(tutao.util.EncodingConverter.keyToUint8Array(t)))},tutao.crypto.Utils.checkIs128BitKey=function(t){var r=sjcl.bitArray.bitLength(t);if(128==r)return!0;if(256==r)return!1;throw new tutao.crypto.CryptoError("invalid key bit length: "+r)};
"use strict";tutao.provide("tutao.util.EncodingConverter"),tutao.util.EncodingConverter.keyToUint8Array=function(t){return new Uint8Array(sjcl.codec.arrayBuffer.fromBits(t))},tutao.util.EncodingConverter.uint8ArrayToKey=function(t){return sjcl.codec.arrayBuffer.toBits(t.buffer)},tutao.util.EncodingConverter.keyToBase64=function(t){return sjcl.codec.base64.fromBits(t)},tutao.util.EncodingConverter.base64ToKey=function(t){try{return sjcl.codec.base64.toBits(t)}catch(r){throw new tutao.crypto.CryptoError("hex to aes key failed",r)}},tutao.util.EncodingConverter.hexToBase64=function(t){return sjcl.codec.base64.fromBits(sjcl.codec.hex.toBits(t))},tutao.util.EncodingConverter.base64ToHex=function(t){return sjcl.codec.hex.fromBits(sjcl.codec.base64.toBits(t))},tutao.util.EncodingConverter.base64ToBase64Url=function(t){var r=t.replace(/\+/g,"-");return r=r.replace(/\//g,"_"),r=r.replace(/=/g,"")},tutao.util.EncodingConverter.base64ToBase64Ext=function(t){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";t=t.replace(/=/g,"");for(var n=new Array(t.length),o=0;o<t.length;o++){var a=r.indexOf(t.charAt(o));n[o]=e[a]}return n.join("")},tutao.util.EncodingConverter.timestampToHexGeneratedId=function(t){for(var r=4*t,e=parseInt(r).toString(16)+"0000000",n=e.length;18>n;n++)e="0"+e;return e},tutao.util.EncodingConverter.timestampToGeneratedId=function(t){var r=tutao.util.EncodingConverter.timestampToHexGeneratedId(t);return tutao.util.EncodingConverter.base64ToBase64Ext(tutao.util.EncodingConverter.hexToBase64(r))},tutao.util.EncodingConverter.base64UrlToBase64=function(t){var r=t.replace(/\-/g,"+");r=r.replace(/_/g,"/");var e=r.length%4;if(0===e)return r;if(2===e)return r+"==";if(3===e)return r+"=";throw new Error("Illegal base64 string.")},tutao.util.EncodingConverter.stringToUtf8Uint8Array=function(t){for(var r=unescape(encodeURIComponent(t)),e=new Uint8Array(r.length),n=0;n<r.length;n++)e[n]=r.charCodeAt(n);return e},tutao.util.EncodingConverter.utf8Uint8ArrayToString=function(t){return decodeURIComponent(escape(String.fromCharCode.apply(null,t)))},tutao.util.EncodingConverter.hexToUint8Array=function(t){for(var r=new Uint8Array(t.length/2),e=0;e<r.byteLength;e++)r[e]=parseInt(t.substring(2*e,2*e+2),16);return r},tutao.util.EncodingConverter.uint8ArrayToHex=function(t){for(var r="0123456789abcdef",e="",n=0;n<t.byteLength;n++){var o=t[n];e+=r[o>>4]+r[15&o]}return e},tutao.util.EncodingConverter.uint8ArrayToBase64=function(t){for(var r="",e=t.byteLength,n=0;e>n;n++)r+=String.fromCharCode(t[n]);return btoa(r)},tutao.util.EncodingConverter.base64ToUint8Array=function(t){return new Uint8Array(atob(t).split("").map(function(t){return t.charCodeAt(0)}))};
"use strict";tutao.provide("tutao.crypto.AesInterface"),tutao.crypto.AesInterface=function(){},tutao.crypto.AesInterface.IV_BYTE_LENGTH=16,tutao.crypto.AesInterface.IV_BIT_LENGTH=8*tutao.crypto.AesInterface.IV_BYTE_LENGTH,tutao.crypto.AesInterface.TAG_BYTE_LENGTH=16,tutao.crypto.AesInterface.TAG_BIT_LENGTH=8*tutao.crypto.AesInterface.TAG_BYTE_LENGTH,tutao.crypto.AesInterface.prototype.generateRandomKey=function(){},tutao.crypto.AesInterface.prototype.encryptUtf8=function(){},tutao.crypto.AesInterface.prototype.decryptUtf8=function(){},tutao.crypto.AesInterface.prototype.encryptUtf8Index=function(){},tutao.crypto.AesInterface.prototype.decryptUtf8Index=function(){},tutao.crypto.AesInterface.prototype.encryptBytes=function(){},tutao.crypto.AesInterface.prototype.decryptBytes=function(){},tutao.crypto.AesInterface.prototype.encryptKey=function(){},tutao.crypto.AesInterface.prototype.decryptKey=function(){},tutao.crypto.AesInterface.prototype.encryptPrivateRsaKey=function(){},tutao.crypto.AesInterface.prototype.decryptPrivateRsaKey=function(){};
"use strict";tutao.provide("tutao.crypto.SjclAes128CbcAsync"),tutao.crypto.SjclAes128CbcAsync=function(){this._byteKeyLength=16},tutao.crypto.SjclAes128CbcAsync.prototype.encryptBytes=function(t,e,n,i){try{for(var r=sjcl.codec.arrayBuffer.toBits(n.buffer),y=sjcl.bitArray._xor4,s=this._byteKeyLength/4,h=new sjcl.cipher.aes(t),o=Math.floor(e.length/this._byteKeyLength),a=new ArrayBuffer((o+2)*this._byteKeyLength),c=new DataView(e.buffer),g=new DataView(a),U=0;s>U;U++)g.setUint32(4*U,this._int32ToUint32(r[U]),!1);for(var f=[0,0,0,0],U=0;o*s>U;U+=s){f[0]=c.getUint32(4*U,!1),f[1]=c.getUint32(4*(U+1),!1),f[2]=c.getUint32(4*(U+2),!1),f[3]=c.getUint32(4*(U+3),!1),r=h.encrypt(y(r,f));var b=4*(s+U);g.setUint32(b,this._int32ToUint32(r[0]),!1),g.setUint32(b+4,this._int32ToUint32(r[1]),!1),g.setUint32(b+8,this._int32ToUint32(r[2]),!1),g.setUint32(b+12,this._int32ToUint32(r[3]),!1)}var U,l=new DataView(new ArrayBuffer(this._byteKeyLength)),u=e.length-o*this._byteKeyLength;for(U=0;u>U;U++)l.setUint8(U,c.getUint8(o*this._byteKeyLength+U));for(var _=this._byteKeyLength-e.length%this._byteKeyLength;U<this._byteKeyLength;U++)l.setUint8(U,_);f[0]=l.getUint32(0,!1),f[1]=l.getUint32(4,!1),f[2]=l.getUint32(8,!1),f[3]=l.getUint32(12,!1),r=h.encrypt(y(r,f));var p=(o+1)*this._byteKeyLength;g.setUint32(p,this._int32ToUint32(r[0]),!1),g.setUint32(p+4,this._int32ToUint32(r[1]),!1),g.setUint32(p+8,this._int32ToUint32(r[2]),!1),g.setUint32(p+12,this._int32ToUint32(r[3]),!1),i({type:"result",result:new Uint8Array(a)})}catch(w){i({type:"error",msg:"SjclAes128CbcAsync encrypt error:"+w.message})}},tutao.crypto.SjclAes128CbcAsync.prototype.decryptBytes=function(t,e,n,i){try{var r=e.byteLength%2==1;if(r){var y=(new tutao.crypto.SjclSha256).hash(tutao.util.EncodingConverter.keyToUint8Array(t));t=tutao.util.EncodingConverter.uint8ArrayToKey(y.slice(0,16))}for(var s=sjcl.bitArray._xor4,h=this._byteKeyLength/4,o=new sjcl.cipher.aes(t),a=(e.length-(r?33:0))/this._byteKeyLength-2,c=new ArrayBuffer(n),g=new DataView(e.buffer,r?1:0,r?e.length-33:e.length),U=new DataView(c),f=[],b=0;h>b;b++)f.push(g.getUint32(4*b,!1));g=new DataView(e.buffer,this._byteKeyLength+(r?1:0),r?e.length-this._byteKeyLength-33:e.length-this._byteKeyLength);for(var l=null,b=0;(a+1)*h>b;b+=h){var u=[g.getUint32(4*b,!1),g.getUint32(4*(b+1),!1),g.getUint32(4*(b+2),!1),g.getUint32(4*(b+3),!1)];if(l=s(f,o.decrypt(u)),a*h>b)U.setUint32(4*b,l[0],!1),U.setUint32(4*b+4,l[1],!1),U.setUint32(4*b+8,l[2],!1),U.setUint32(4*b+12,l[3],!1),f=u;else{for(var _=new DataView(new ArrayBuffer(this._byteKeyLength)),p=0;h>p;p++)_.setUint32(4*p,this._int32ToUint32(l[p]),!1);var w=255&l[3];if(0==w||w>16)throw new Error("invalid padding value: "+w);if(n!=(a+1)*this._byteKeyLength-w)throw new Error("invalid decrypted size: "+n+", expected: "+(a*this._byteKeyLength+w));var p;for(p=0;p<this._byteKeyLength-w;p++)U.setUint8(a*this._byteKeyLength+p,_.getUint8(p));for(;p<this._byteKeyLength;p++)if(_.getUint8(p)!=w)throw new Error("invalid padding byte found: "+_.getUint8(p)+", expected: "+w)}}i({type:"result",result:new Uint8Array(c)})}catch(A){i({type:"error",msg:"SjclAes128CbcAsync decrypt error: "+A.message})}},tutao.crypto.SjclAes128CbcAsync.prototype._int32ToUint32=function(t){return 0>t?t+4294967296:t};
"use strict";tutao.provide("tutao.crypto.SjclAes256GcmAsync"),tutao.crypto.SjclAes256GcmAsync=function(){},tutao.crypto.SjclAes256GcmAsync.prototype.encryptBytes=function(t,r,c,e){try{var s=tutao.crypto.Utils.pad(r),o=sjcl.codec.arrayBuffer.toBits(s.buffer),a=sjcl.codec.arrayBuffer.toBits(c.buffer),y=sjcl.mode.gcm.encrypt(new sjcl.cipher.aes(t),o,a,[],tutao.crypto.AesInterface.TAG_BIT_LENGTH),p=sjcl.bitArray.concat(a,y);e({type:"result",result:new Uint8Array(sjcl.codec.arrayBuffer.fromBits(p))})}catch(u){e({type:"error",msg:"SjclAes1256Gcm encryption error: "+u.message})}},tutao.crypto.SjclAes256GcmAsync.prototype.decryptBytes=function(t,r,c,e){try{var s=sjcl.codec.arrayBuffer.toBits(r.buffer),o=sjcl.bitArray.bitSlice(s,0,tutao.crypto.AesInterface.IV_BIT_LENGTH),a=sjcl.bitArray.bitSlice(s,tutao.crypto.AesInterface.IV_BIT_LENGTH),y=sjcl.mode.gcm.decrypt(new sjcl.cipher.aes(t),a,o,[],tutao.crypto.AesInterface.TAG_BIT_LENGTH),p=new Uint8Array(sjcl.codec.arrayBuffer.fromBits(y)),u=tutao.crypto.Utils.unpad(p);e({type:"result",result:u})}catch(n){e({type:"error",msg:"SjclAes1256Gcm decryption error: "+n.message})}};
"use strict";tutao.provide("tutao.crypto.SjclSha256"),tutao.crypto.SjclSha256=function(){this._hasher=new sjcl.hash.sha256},tutao.crypto.SjclSha256.prototype.hash=function(t){return this._hasher.reset(),this._hasher.update(sjcl.codec.arrayBuffer.toBits(t.buffer)),new Uint8Array(sjcl.codec.arrayBuffer.fromBits(this._hasher.finalize()))};
//# sourceMappingURL=worker.min.js.map